webpackJsonp([5],{"7nPU":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("rVsN"),s=e.n(i),o=e("wSez"),n={name:"crawl",components:{},data:function(){return{popupVisible:!1,RangeList:["500","1000","1500","2000","2500","3000"],zict:{500:16,1000:15,1500:14,2000:14,2500:14,3000:13},Range:"1000",map:"",zoom:15,crawlCode:{lng:114.308136,lat:30.603689},codeMess:null,wlmc:""}},watch:{Range:function(t,a){this.popupVisible=!1,this.zoom=this.zict[t],this.BmapClear(),this.BuildMap()},crawlCode:function(t,a){var e=this;this.BmapClear(),this.addMarkerCode(new BMap.Point(this.crawlCode.lng,this.crawlCode.lat)),this.addMarkerCrawl(new BMap.Point(this.crawlCode.lng,this.crawlCode.lat),this.Range),this.getMapAddress(t).then(function(t){e.codeMess=t}).catch(function(t){})}},created:function(){console.log("车辆666",this.$route.params.carIds)},mounted:function(){var t=this;this.$nextTick(function(){t.BuildMap()})},methods:{setCrawlName:function(){var t=this,a=this;o.MessageBox.prompt("给围栏起个名字吧？").then(function(e){var i=e.value,s=e.action;i&&"confirm"==s?(a.wlmc=i,a.goCrawlList()):i||"confirm"!=s||t.Toast({message:"没有名字的围栏,不能被创建呦!",duration:4e3})})},goCrawlList:function(){var t=this;this.$http.post("/app/dzwl/save",{wlmc:this.wlmc,ksjd:this.crawlCode.lng,kswd:this.crawlCode.lat,wlfw:this.Range,dlxxzb:this.codeMess.address,clIds:this.$route.params.carIds}).then(function(a){200==a.code&&(t.Toast({message:"围栏添加成功",duration:2e3}),t.$router.push({name:"crawlList"}))}).catch(function(t){})},goback:function(){this.$router.back()},BuildMap:function(){var t=this,a=this;this.map=new BMap.Map("mapCrawl",{enableMapClick:!1});var e=new BMap.Point(this.crawlCode.lng,this.crawlCode.lat);this.map.centerAndZoom(e,this.zoom),this.map.addControl(new BMap.MapTypeControl({mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]})),this.map.enableScrollWheelZoom(!0),this.map.addControl(new BMap.NavigationControl),this.getMapAddress(a.map.getCenter()).then(function(a){t.codeMess=a}).catch(function(t){}),this.addMarkerCrawl(e,this.Range),this.addMarkerCode(e),this.BmapEvent(["zoomend","moving"],a,function(t){a.BmapClear(),a.crawlCode=t.code,a.addMarkerCode(new BMap.Point(t.code.lng,t.code.lat))})},BmapEvent:function(t,a,e){var i={};t.forEach(function(t,s){a.map.addEventListener(t,function(){i.zoom=a.map.getZoom(),i.code=a.map.getCenter(),e&&e(i)})})},addMarkerCode:function(t){var a=new BMap.Marker(t);this.map.addOverlay(a),a.setAnimation(BMAP_ANIMATION_BOUNCE)},addMarkerCrawl:function(t,a){var e=new BMap.Circle(t,a,{strokeColor:"blue",strokeWeight:2,strokeOpacity:.5});this.map.addOverlay(e)},getMapAddress:function(t){return new s.a(function(a,e){(new BMap.Geocoder).getLocation(new BMap.Point(t.lng,t.lat),function(t){a(t),e(t)})})},BmapClear:function(){this.map.clearOverlays()}}},c={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"box_col"},[e("div",{staticClass:"titbox mapAppTitSty"},[e("div",{staticClass:"tit box_row"},[e("div",{staticClass:"box_row_100 TITleft",on:{click:t.goback}},[e("i",{staticClass:"iconfont icon-jiantouarrowhead7"})]),t._v(" "),e("div",{staticClass:"box_row_100 TITMess"},[t._v("\n        电子围栏\n      ")]),t._v(" "),e("div",{staticClass:"box_row_100 TITRight"})])]),t._v(" "),e("div",{staticClass:"codeMessSty"},[e("div",{staticClass:"address"},[e("img",{attrs:{src:"static/img/GPS.png",width:"30px",alt:""}}),t._v(" "),t.codeMess?e("div",{staticClass:"text"},[t._v("\n        "+t._s(t.codeMess.address)+"\n      ")]):e("div",{staticClass:"text"},[t._v("\n        暂无位置信息\n      ")])]),t._v(" "),e("mt-cell",{staticClass:"RangeSty",attrs:{title:"围栏范围"}},[e("div",{staticStyle:{color:"#2b85e4"},on:{click:function(a){t.popupVisible=!t.popupVisible}}},[t._v(t._s(t.Range)+"米  "),e("i",{staticClass:"iconfont icon-jiantou"})])])],1),t._v(" "),t._m(0),t._v(" "),e("div",{staticStyle:{padding:"8px 12px","background-color":"#f5f5f5","border-top":"solid 2px #d9d9d9"}},[e("mt-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:t.setCrawlName}},[t._v("完 成")])],1),t._v(" "),e("mt-popup",{attrs:{"popup-transition":"popup-fade"},model:{value:t.popupVisible,callback:function(a){t.popupVisible=a},expression:"popupVisible"}},[e("div",{staticStyle:{width:"300px"}},[e("mt-radio",{attrs:{title:"围栏范围",align:"right",options:t.RangeList},model:{value:t.Range,callback:function(a){t.Range=a},expression:"Range"}})],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"box_col_100",staticStyle:{position:"relative"}},[a("div",{staticStyle:{width:"100%",height:"100%","background-color":"#2b85e4"},attrs:{id:"mapCrawl"}})])}]};var r=e("C7Lr")(n,c,!1,function(t){e("iZPC")},null,null);a.default=r.exports},iZPC:function(t,a){}});
//# sourceMappingURL=5.fd869f7cdfa41dda71d0.js.map